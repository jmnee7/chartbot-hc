<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCT DREAM ìŠ¤íŠ¸ë¦¬ë°</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@1.3.8/dist/web/static/pretendard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link rel="stylesheet" href="styles/main.css?v=2.5">
  </head>
  <body>
    <!-- Top App Bar -->
    <div class="topbar">
      <div class="topbar__title" id="homeTitle" role="button" tabindex="0" aria-label="í™ˆìœ¼ë¡œ ì´ë™">ğŸ» í•´ì°¬ ìŠ¤íŠ¸ë¦¬ë°</div>
      <div class="topbar__actions">
        <button class="hamburger" id="hamburgerBtn" aria-label="ë©”ë‰´ ì—´ê¸°" aria-expanded="false">
          <span class="hamburger__bars"></span>
        </button>
      </div>
    </div>

    <!-- Slide-out Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu" aria-hidden="true">
      <div class="mobile-menu__header">
        <button class="menu-close" id="menuCloseBtn" aria-label="ë‹«ê¸°">âœ•</button>
      </div>
      <a href="#" onclick="openDashboardSection('rank-section'); return false;">ìŠ¤íŠ¸ë¦¬ë° ë¦¬ìŠ¤íŠ¸</a>
      <a href="#" onclick="openChecklist('pre'); return false;">ğŸŒ»ìŒì› ë°œë§¤ ì „ë‚  ì²´í¬ë¦¬ìŠ¤íŠ¸ğŸŒ»</a>
      <a href="#" onclick="openChecklist('release'); return false;">ğŸŒ»ìŒì› ë°œë§¤ ë‹¹ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ğŸŒ»</a>

      <!-- ê°€ì´ë“œ ìƒìœ„ ë° í•˜ìœ„ ë©”ë‰´ -->
      <a href="#" id="guideParent" onclick="toggleSubmenu('guide'); return false;">ê°€ì´ë“œ â–¾</a>
      <div class="submenu" id="guideSubmenu" style="display: none;">
        <a href="#" onclick="openGuideMenu('id'); closeMenu(); return false;">ì•„ì´ë”” ê°€ì´ë“œ</a>
        <a href="#" onclick="openGuideMenu('streaming'); closeMenu(); return false;">ìŠ¤íŠ¸ë¦¬ë° ê°€ì´ë“œ</a>
        <a href="#" onclick="openGuideMenu('music'); closeMenu(); return false;">ë‹¤ìš´ë¡œë“œ ê°€ì´ë“œ</a>
        <a href="#" onclick="openGuideMenu('vote'); closeMenu(); return false;">íˆ¬í‘œ ê°€ì´ë“œ</a>
        <a href="#" onclick="openGuideMenu('stability'); closeMenu(); return false;">ê¸°íƒ€ ê°€ì´ë“œ</a>
      </div>

      <!-- ê¸°íƒ€ ìƒìœ„ ë° í•˜ìœ„ ë©”ë‰´ -->
      <a href="#" id="etcParent" onclick="toggleSubmenu('etc'); return false;">ê¸°íƒ€ â–¾</a>
      <div class="submenu" id="etcSubmenu" style="display: none;">
        <a href="#" onclick="openDashboardSection('streaming-section'); return false;">ì›í´ë¦­ ìŠ¤íŠ¸ë¦¬ë°</a>
        <a href="#" onclick="openDashboardSection('radio-section'); return false;">ì›í´ë¦­ ë¼ë””ì˜¤ ì‹ ì²­</a>
        <a href="#" onclick="openDashboardSection('groupbuy-section'); return false;">ê³µë™êµ¬ë§¤</a>
        <a href="#" onclick="openGuideMenu('vote'); closeMenu(); return false;">íˆ¬í‘œ</a>
        <a href="#" onclick="openDashboardSection('rank-section'); return false;">ì°¨íŠ¸</a>
        <a href="#" onclick="openNotice(); return false;">ê³µì§€ì‚¬í•­</a>
      </div>
    </div>
    <div class="backdrop" id="menuBackdrop"></div>

    <main id="dashboard-view" class="container">
      <div class="dashboard-grid">
        <!-- Home Banner Slider -->
        <div class="card banner-section" id="home-banner">
          <div class="banner-slider" id="bannerSlider">
            <div class="banner-slide"><img src="assets/home/banner/ê³µë™êµ¬ë§¤.jpeg" alt="ê³µë™êµ¬ë§¤ ë°°ë„ˆ"></div>
            <div class="banner-slide"><img src="assets/home/banner/ì•„ì´ë””ê°€ì´ë“œ.jpeg" alt="ì•„ì´ë”” ê°€ì´ë“œ ë°°ë„ˆ"></div>
            <div class="banner-slide"><img src="assets/home/banner/íˆ¬í‘œê°€ì´ë“œ.jpeg" alt="íˆ¬í‘œ ê°€ì´ë“œ ë°°ë„ˆ"></div>
          </div>
          <button class="banner-nav prev" id="bannerPrev" aria-label="ì´ì „">â€¹</button>
          <button class="banner-nav next" id="bannerNext" aria-label="ë‹¤ìŒ">â€º</button>
          <div class="banner-dots" id="bannerDots"></div>
        </div>
        <!-- Rank moved to bottom later -->
        <section class="chart-layout" id="rank-section-container">
          <div class="card" id="rank-section">
            <h2><span class="card-icon">ğŸ†</span>ì‹¤ì‹œê°„ ìˆœìœ„ <small>(<span id="lastUpdate"></span>)</small></h2>
            <div class="rank-grid">
              <div class="rank-card">
                <div class="rank-header">
                  <span class="rank-service-name"><img src="images/melon.png" class="service-logo">ë©œë¡  TOP100</span>
                  <span class="rank-badge" id="melon-top-badge"></span>
                </div>
                <div class="rank-info">
                  <span class="rank-number" id="melon-top-rank">-</span>
                  <span class="rank-change" id="melon-top-change"></span>
                </div>
              </div>
              <div class="rank-card">
                <div class="rank-header">
                  <span class="rank-service-name"><img src="images/melon.png" class="service-logo">ë©œë¡  HOT100</span>
                  <span class="rank-badge" id="melon-hot-badge"></span>
                </div>
                <div class="rank-info">
                  <span class="rank-number" id="melon-hot-rank">-</span>
                  <span class="rank-change" id="melon-hot-change"></span>
                </div>
              </div>
              <div class="rank-card">
                <div class="rank-header">
                  <span class="rank-service-name"><img src="images/bugs.ico" class="service-logo">ë²…ìŠ¤</span>
                  <span class="rank-badge" id="bugs-badge"></span>
                </div>
                <div class="rank-info">
                  <span class="rank-number" id="bugs-rank">-</span>
                  <span class="rank-change" id="bugs-change"></span>
                </div>
              </div>
              <div class="rank-card">
                <div class="rank-header">
                  <span class="rank-service-name"><img src="images/genie.png" class="service-logo">ì§€ë‹ˆ</span>
                  <span class="rank-badge" id="genie-badge"></span>
                </div>
                <div class="rank-info">
                  <span class="rank-number" id="genie-rank">-</span>
                  <span class="rank-change" id="genie-change"></span>
                </div>
              </div>
              <div class="rank-card">
                <div class="rank-header">
                  <span class="rank-service-name"><img src="images/vibe.ico" class="service-logo">ë°”ì´ë¸Œ</span>
                  <span class="rank-badge" id="vibe-badge"></span>
                </div>
                <div class="rank-info">
                  <span class="rank-number" id="vibe-rank">-</span>
                  <span class="rank-change" id="vibe-change"></span>
                </div>
              </div>
              <div class="rank-card">
                <div class="rank-header">
                  <span class="rank-service-name"><img src="images/flo.ico" class="service-logo">í”Œë¡œ</span>
                  <span class="rank-badge" id="flo-badge"></span>
                </div>
                <div class="rank-info">
                  <span class="rank-number" id="flo-rank">-</span>
                  <span class="rank-change" id="flo-change"></span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Quick Actions Layout -->
        <div class="quick-actions-row two-col">
          <div class="card" id="streaming-section">
            <h2 class="section-title"><span class="emoji">ğŸµ</span>ì›í´ë¦­ ìŠ¤íŠ¸ë¦¬ë°</h2>
            <div class="streaming-links">
              <a href="https://www.melon.com/yplayer/streamingguide/index.htm" target="_blank" class="btn" rel="noopener">ë©œë¡  ë®¤ì§ì›¨ì´ë¸Œ ë°”ë¡œê°€ê¸°</a>
              <a href="#" class="streaming-btn melon no-border" onclick="goToStreaming('melon')">ë©œë¡ </a>
              <a href="#" class="streaming-btn genie no-border" onclick="goToStreaming('genie')">ì§€ë‹ˆ</a>
              <a href="#" class="streaming-btn bugs no-border" onclick="goToStreaming('bugs')">ë²…ìŠ¤</a>
              <a href="#" class="streaming-btn vibe no-border" onclick="goToStreaming('vibe')">ë°”ì´ë¸Œ</a>
              <a href="#" class="streaming-btn flo no-border" onclick="goToStreaming('flo')">í”Œë¡œ</a>
            </div>
          </div>
        </div>

        <div class="quick-actions-row three-col">
          <div class="card" id="groupbuy-section">
            <h2 class="section-title"><span class="emoji">ğŸ›’</span>ê³µë™êµ¬ë§¤</h2>
            <div class="group-buy-links">
              <button class="btn" onclick="openGroupBuyModal('applemusic')">ì• í”Œë®¤ì§</button>
              <button class="btn" onclick="openGroupBuyModal('allmd')">ì˜¬ì— ë””</button>
              <button class="btn" onclick="openGroupBuyModal('minirecord')">ë¯¸ë‹ˆë ˆì½”ë“œ</button>
              <button class="btn" onclick="openGroupBuyModal('everline')">ì—ë²„ë¼ì¸</button>
            </div>
          </div>

          <div class="card" id="radio-section">
            <h2 class="section-title"><span class="emoji">ğŸ“»</span>ì›í´ë¦­ ë¼ë””ì˜¤ ì‹ ì²­</h2>
            <div class="radio-links">
              <a href="sms:#8910&body=NCT DREAM BTF ì‹ ì²­í•©ë‹ˆë‹¤." class="btn">KBS</a>
              <a href="sms:#8000&body=NCT DREAM BTF ì‹ ì²­í•©ë‹ˆë‹¤." class="btn">MBC</a>
              <a href="sms:#1077&body=NCT DREAM BTF ì‹ ì²­í•©ë‹ˆë‹¤." class="btn">SBS</a>
            </div>
          </div>
        </div>

        <div class="quick-actions-row">
          <div class="card youtube-section" style="grid-column: 1 / -1;">
            <h2 class="section-title"><span class="emoji">ğŸ“ˆ</span>ìœ íŠœë¸Œ ì¶”ì´</h2>
            <div class="video-container">
              <iframe src="https://www.youtube.com/embed/3rsBWr3JOUI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            <div class="youtube-stats-display">
              <div class="stat-item">
                <span class="stat-label">ì¡°íšŒìˆ˜</span>
                <span class="stat-value" id="viewCount">-</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">ì¢‹ì•„ìš”</span>
                <span class="stat-value" id="likeCount">-</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Move Rank section to the very bottom of dashboard grid -->
        <section class="chart-layout" style="grid-column: 1 / -1;">
          <div class="card" aria-hidden="true" style="display:none"></div>
        </section>
      </div>
    </main>

    <section id="guide-view" class="container" style="display: none;">
      <div class="card">
        <div class="guide-hub">
          <div id="streaming-grid" style="display: none;">
            <div class="guide-grid">
              <button class="guide-item" onclick="openStreamingGuide('melon')">ë©œë¡  ìŠ¤íŠ¸ë¦¬ë° ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openStreamingGuide('genie')">ì§€ë‹ˆ ìŠ¤íŠ¸ë¦¬ë° ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openStreamingGuide('bugs')">ë²…ìŠ¤ ìŠ¤íŠ¸ë¦¬ë° ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openStreamingGuide('vibe')">ë°”ì´ë¸Œ ìŠ¤íŠ¸ë¦¬ë° ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openStreamingGuide('flo')">í”Œë¡œ ìŠ¤íŠ¸ë¦¬ë° ê°€ì´ë“œ</button>
            </div>
          </div>

          <div id="id-grid" style="display: none;">
            <div class="guide-grid">
              <button class="guide-item" onclick="openIdCategoryGrid('dualnumber', this)">ë“€ì–¼ ë„˜ë²„ ìƒì„± ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openIdCategoryGrid('id', this)">ì•„ì´ë”” ìƒì„± ê°€ì´ë“œ</button>
            </div>
            <div id="id-subgrid" class="guide-grid" style="display: none;"></div>
          </div>

          <div id="download-grid" style="display: none;">
            <div class="guide-grid">
              <button class="guide-item" onclick="openDownloadGuide('music','melon')">ë©œë¡  ìŒì› ë‹¤ìš´ë¡œë“œ</button>
              <button class="guide-item" onclick="openDownloadGuide('music','genie')">ì§€ë‹ˆ ìŒì› ë‹¤ìš´ë¡œë“œ</button>
              <button class="guide-item" onclick="openDownloadGuide('music','bugs')">ë²…ìŠ¤ ìŒì› ë‹¤ìš´ë¡œë“œ</button>
              <button class="guide-item" onclick="openDownloadGuide('music','vibe')">ë°”ì´ë¸Œ ìŒì› ë‹¤ìš´ë¡œë“œ</button>
              <button class="guide-item" onclick="openDownloadGuide('music','kakao')">ì¹´ì¹´ì˜¤ë®¤ì§ ìŒì› ë‹¤ìš´ë¡œë“œ</button>
              <button class="guide-item" onclick="openDownloadGuide('mv','melon')">ë©œë¡  ë®¤ë¹„ ë‹¤ìš´ë¡œë“œ</button>
              <button class="guide-item" onclick="openDownloadGuide('mv','bugs')">ë²…ìŠ¤ ë®¤ë¹„ ë‹¤ìš´ë¡œë“œ</button>
            </div>
          </div>

          <div id="vote-grid" style="display: none;">
            <div class="guide-grid">
              <button class="guide-item" onclick="openVoteGuide('mubit')">ë®¤ë¹—</button>
              <button class="guide-item" onclick="openVoteGuide('starplanet')">ìŠ¤íƒ€í”Œë˜ë‹›</button>
              <button class="guide-item" onclick="openVoteGuide('champ')">ì±”í”„</button>
              <button class="guide-item" onclick="openVoteGuide('fancast')">íŒ¬ìºìŠ¤íŠ¸</button>
              <button class="guide-item" onclick="openVoteGuide('higher')">í•˜ì´ì–´</button>
            </div>
          </div>

          <div id="other-grid" style="display: none;">
            <div class="guide-grid">
              <button class="guide-item" onclick="openOtherGuide('radio')">ë¼ë””ì˜¤ ì‹ ì²­ ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openOtherGuide('vcoloring')">V ì»¬ëŸ¬ë§ ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openOtherGuide('block')">ëŠê¹€ ë°©ì§€ ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openOtherGuide('samsung')">ì‚¼ì„±ë®¤ì§ í™œìš© ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openOtherGuide('shorts')">ìˆí¼ ì œì‘ ê°€ì´ë“œ</button>
              <button class="guide-item" onclick="openOtherGuide('gift')">ë©œë¡  ì„ ë¬¼í•˜ê¸°</button>
            </div>
          </div>
        </div>

        <div class="guide-content" style="display: none; margin-top: 16px;">
          <div class="guide-image-container">
            <img id="guideImage" class="guide-image" alt="ê°€ì´ë“œ ì´ë¯¸ì§€" />
          </div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <p>í•´ì°¬ ìŠ¤íŠ¸ë¦¬ë°</p>
      <p>e-mail : haechanstreamteam@gmail.com</p>
      <p>Copyright 2025. HAECHAN STREAM All Rights Reserved.</p>
    </footer>

    <!-- Group Buy Modal -->
    <div id="gbModal" class="modal">
      <div class="modal-content">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
          <h3 id="gbTitle" style="margin:0;">ê³µë™êµ¬ë§¤</h3>
          <button onclick="closeGbModal()" class="btn">ë‹«ê¸°</button>
        </div>
        <div id="gbBody" class="guide-grid"></div>
      </div>
    </div>

    <script src="js/dashboard.js?v=2.5"></script>
    <script src="js/chart.js?v=2.5"></script>
    <script src="js/guide.js?v=2.5"></script>
    <script>
      const hamburgerBtn = document.getElementById('hamburgerBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const backdrop = document.getElementById('menuBackdrop');

      function openMenu() {
        mobileMenu.classList.add('open');
        backdrop.classList.add('visible');
        hamburgerBtn.setAttribute('aria-expanded', 'true');
        mobileMenu.setAttribute('aria-hidden', 'false');
      }
      function closeMenu() {
        mobileMenu.classList.remove('open');
        backdrop.classList.remove('visible');
        hamburgerBtn.setAttribute('aria-expanded', 'false');
        mobileMenu.setAttribute('aria-hidden', 'true');
      }
      function toggleMenu() {
        if (mobileMenu.classList.contains('open')) { closeMenu(); } else { openMenu(); }
      }

      hamburgerBtn.addEventListener('click', toggleMenu);
      document.getElementById('menuCloseBtn').addEventListener('click', closeMenu);
      backdrop.addEventListener('click', closeMenu);
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });

      // Home title click -> go home (dashboard)
      const homeTitle = document.getElementById('homeTitle');
      if (homeTitle) {
        homeTitle.addEventListener('click', () => { showView('dashboard'); });
        homeTitle.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { showView('dashboard'); } });
      }

      // Submenu toggle for 'ê°€ì´ë“œ' and 'ê¸°íƒ€'
      function toggleSubmenu(menu) {
        const submenu = document.getElementById(`${menu}Submenu`);
        const parent = document.getElementById(`${menu}Parent`);
        const isOpen = submenu.style.display === 'block';
        submenu.style.display = isOpen ? 'none' : 'block';
        if (parent) {
          const label = menu === 'guide' ? 'ê°€ì´ë“œ' : 'ê¸°íƒ€';
          parent.textContent = isOpen ? `${label} â–¾` : `${label} â–´`;
        }
      }

      // Open guide view with specific type (direct routing)
      function openGuideMenu(type) {
        showView('guide');
        closeMenu();
        if (typeof switchGuideTab === 'function') {
          switchGuideTab(type);
        }
      }

      // Open dashboard specific section helper
      function openDashboardSection(sectionId) {
        showView('dashboard');
        closeMenu();
        if (!sectionId) return;
        const el = document.getElementById(sectionId);
        if (el) {
          el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }

      // Open simple checklists (placeholder)
      function openChecklist(type) {
        showView('dashboard');
        closeMenu();
        alert('ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.ğŸ»');
      }

      // Open notice (placeholder)
      function openNotice() {
        showView('dashboard');
        closeMenu();
        alert('ê³µì§€ì‚¬í•­ì€ ê³§ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.');
      }
    </script>
  </body>
  </html>